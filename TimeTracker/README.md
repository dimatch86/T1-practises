# TimeTracker App

---
Приложение для измерения и мониторинга времени выполнения методов, реализовано в виде отдельного модуля "TimeTracker", 
который подключается в качестве библиотеки в основное приложение ("AbstractApp"). 
Предоставляет возможность измерять и записывать в базу данных информацию о 
длительности исполнения методов приложения с помощью аннтотаций: @TrackAsyncTime - для методов, которые выполняются асинхронно, @TrackTime - для синхронных методов.
Функция измерения и записи может быть отключена в зависимости от значения свойства `tracker.enable` `true` или `false` в файле [application.yml](AbstractApp/src/main/resources/application.yml)

---
## Локальный запуск

### Требования

Проект использует синтаксис Java 17. Для локального запуска вам потребуется
Docker Desktop для запуска контейнера с базой данных Postgres.

---
### Запуск приложения в среде разработки

В корне проекта находится файл [docker-compose.yml](docker-compose.yml) c контейнером базы данных PostgreSQL.
Откройте файл docker-compose в среде разработки и нажмите на значок запуска напротив строки "services",
или в командной строке перейдите в папку с проектом и запустите командой:

```bash
docker-compose up -d
```

После этого запускаем приложение из класса [AbstractApp/src/main/java/com/t1/Main.java](AbstractApp/src/main/java/com/t1/Main.java).
После запуска приложение будет доступно на порту http://localhost:8080.

---
## Описание запросов

В корне проекта в папке 'rest-examples' находится [файл](rest-examples/T1.postman_collection.json) с коллекцией запросов, которую можно импортировать в Postman.
Описание запросов:

### Запросы тестового приложения

- http://localhost:8080/app/addProduct - добавить продукт, в теле запроса передается объект с полями "name" и "price"
- http://localhost:8080/app/getProduct?name=milk - получить продукт по его названию
- http://localhost:8080/app/addProducts - добавить список продуктов, в теле запроса передается массив объектов с полями "name" и "price"
- http://localhost:8080/app/getProducts?price=10 - получить продукты со стоимостью больше 10

### Запросы сервиса мониторинга

- http://localhost:8080/statistic/avg?name=addProduct - получить среднее время выполнения определенного метода
- http://localhost:8080/statistic/max - получить максимальную длительность выполнения
- http://localhost:8080/statistic/avg-group?group=add - получить среднее время выполнения определенной группы методов
- http://localhost:8080/statistic/maximums - получить список максимальных длительностей для каждого метода
- http://localhost:8080/statistic/greater-than?duration=700 - получить список методов, длительности которых больше заданной в запросе